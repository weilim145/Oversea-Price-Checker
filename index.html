<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Global Shop & Convert</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom scrollbar for the item list */
        #items-container::-webkit-scrollbar { width: 4px; }
        #items-container::-webkit-scrollbar-thumb { background: #475569; border-radius: 10px; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-3 md:p-10 font-sans text-gray-900">

<div class="max-w-2xl mx-auto space-y-4 md:space-y-6">
    
    <div class="bg-white rounded-2xl shadow-lg p-5 border border-gray-100">
        <div class="flex justify-between items-center mb-4">
            <h1 class="text-lg font-bold text-gray-800 flex items-center gap-2"><span>üåç</span> Converter</h1>
            <div class="text-[10px] bg-blue-50 text-blue-600 px-2 py-1 rounded-full font-bold">LIVE RATE: <span id="rate-text">1.00</span></div>
        </div>

        <div class="flex flex-col md:flex-row items-center gap-3">
            <div class="w-full flex gap-2">
                <select id="base-currency" class="bg-gray-50 border rounded-xl px-2 py-3 font-bold text-sm">
                    <option value="USD">USD - US Dollar</option>
                    <option value="EUR">EUR - Euro</option>
                    <option value="GBP">GBP - British Pound</option>
                    <option value="JPY">JPY - Japanese Yen</option>
                    <option value="MYR">MYR - Malaysian Ringgit</option>
                    <option value="SGD">SGD - Singapore Dollar</option>
                    <option value="AUD">AUD - Australian Dollar</option>
                    <option value="CAD">CAD - Canadian Dollar</option>
                    <option value="CNY">CNY - Chinese Yuan</option>
                    <option value="HKD">HKD - Hong Kong Dollar</option>
                    <option value="IDR">IDR - Indonesian Rupiah</option>
                    <option value="INR">INR - Indian Rupee</option>
                    <option value="KRW">KRW - South Korean Won</option>
                    <option value="THB">THB - Thai Baht</option>
                    <option value="VND">VND - Vietnamese Dong</option>
                </select>
                <input type="number" id="input-amount" value="100" class="flex-1 bg-gray-50 border rounded-xl px-3 py-3 font-bold text-lg outline-none focus:ring-2 focus:ring-blue-500">
            </div>

            <button onclick="swapCurrencies()" class="p-2 bg-blue-100 text-blue-600 rounded-full active:scale-90 transition-all">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 rotate-90 md:rotate-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" /></svg>
            </button>

            <div class="w-full flex gap-2">
                <select id="target-currency" class="bg-gray-50 border rounded-xl px-2 py-3 font-bold text-sm">
                    <option value="USD">USD - US Dollar</option>
                    <option value="EUR">EUR - Euro</option>
                    <option value="GBP">GBP - British Pound</option>
                    <option value="JPY">JPY - Japanese Yen</option>
                    <option value="MYR">MYR - Malaysian Ringgit</option>
                    <option value="SGD">SGD - Singapore Dollar</option>
                    <option value="AUD">AUD - Australian Dollar</option>
                    <option value="CAD">CAD - Canadian Dollar</option>
                    <option value="CNY">CNY - Chinese Yuan</option>
                    <option value="HKD">HKD - Hong Kong Dollar</option>
                    <option value="IDR">IDR - Indonesian Rupiah</option>
                    <option value="INR">INR - Indian Rupee</option>
                    <option value="KRW">KRW - South Korean Won</option>
                    <option value="THB">THB - Thai Baht</option>
                    <option value="VND">VND - Vietnamese Dong</option>
                </select>
                <div id="result-display" class="flex-1 bg-blue-50 border border-blue-100 rounded-xl px-3 py-3 font-bold text-lg text-blue-700">0.00</div>
            </div>
        </div>
    </div>

    <div class="bg-slate-900 rounded-2xl shadow-xl p-5 md:p-8 text-white">
        <h2 class="text-lg font-bold mb-4 flex items-center gap-2"><span>üõçÔ∏è</span> Shopping List</h2>

        <div class="flex gap-2 mb-6">
            <input type="number" id="item-input" placeholder="Price (Base)" class="flex-1 bg-slate-800 border border-slate-700 rounded-xl px-4 py-3 text-white outline-none focus:ring-2 focus:ring-blue-500">
            <button onclick="addItem()" class="bg-blue-600 hover:bg-blue-500 px-6 py-3 rounded-xl font-bold transition-all active:scale-95">+</button>
        </div>

        <div id="items-container" class="space-y-2 max-h-48 overflow-y-auto mb-6 pr-2">
            </div>

        <div class="grid grid-cols-2 gap-3 pt-4 border-t border-slate-800">
            <div>
                <label class="block text-[10px] font-bold uppercase text-slate-500 mb-1">Total Discount %</label>
                <input type="number" id="shop-discount" value="0" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm text-white outline-none">
            </div>
            <div>
                <label class="block text-[10px] font-bold uppercase text-slate-500 mb-1">Voucher Value (-)</label>
                <input type="number" id="shop-voucher" value="0" class="w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm text-white outline-none">
            </div>
        </div>

        <div class="mt-6 bg-slate-800 rounded-xl p-5 border border-slate-700">
            <div class="flex justify-between text-xs text-slate-400 mb-1">
                <span>Subtotal (Base)</span>
                <span id="base-subtotal">0.00</span>
            </div>
            <div class="flex justify-between text-xl font-black text-white">
                <span>Final Total</span>
                <span id="shop-final" class="text-blue-400">0.00</span>
            </div>
        </div>
    </div>
</div>

<script>
    let currentExchangeRate = 1.0;
    let shoppingList = [];

    // --- CURRENCY LOGIC ---
    async function fetchRate() {
        const base = document.getElementById('base-currency').value;
        const target = document.getElementById('target-currency').value;
        try {
            const res = await fetch(`https://api.frankfurter.dev/v1/latest?base=${base}&symbols=${target}`);
            const data = await res.json();
            currentExchangeRate = data.rates[target];
            updateUI();
        } catch (e) { console.error("Rate fetch failed"); }
    }

    function swapCurrencies() {
        const base = document.getElementById('base-currency');
        const target = document.getElementById('target-currency');
        const temp = base.value;
        base.value = target.value;
        target.value = temp;
        fetchRate();
    }

    // --- SHOPPING LIST LOGIC ---
    function addItem() {
        const input = document.getElementById('item-input');
        const value = parseFloat(input.value);
        if (!isNaN(value) && value > 0) {
            shoppingList.push(value);
            input.value = "";
            renderList();
            updateUI();
        }
    }

    function removeItem(index) {
        shoppingList.splice(index, 1);
        renderList();
        updateUI();
    }

    function renderList() {
        const container = document.getElementById('items-container');
        const baseCurr = document.getElementById('base-currency').value;
        
        container.innerHTML = shoppingList.map((price, index) => `
            <div class="flex justify-between items-center bg-slate-800/50 p-3 rounded-lg border border-slate-700/50 group">
                <span class="text-sm font-medium text-slate-300">Item ${index + 1}: <span class="text-white font-bold">${baseCurr} ${price.toFixed(2)}</span></span>
                <button onclick="removeItem(${index})" class="text-slate-500 hover:text-red-400 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
                </button>
            </div>
        `).join('');
    }

    // --- GLOBAL UPDATE ---
    function updateUI() {
        const amount = parseFloat(document.getElementById('input-amount').value) || 0;
        const targetCurr = document.getElementById('target-currency').value;
        const baseCurr = document.getElementById('base-currency').value;

        // Update Converter
        const convResult = amount * currentExchangeRate;
        document.getElementById('result-display').textContent = convResult.toLocaleString(undefined, {minimumFractionDigits: 2});
        document.getElementById('rate-text').textContent = currentExchangeRate.toFixed(4);

        // Update Shopping Total
        const subtotal = shoppingList.reduce((acc, curr) => acc + curr, 0);
        const discountPerc = parseFloat(document.getElementById('shop-discount').value) || 0;
        const voucher = parseFloat(document.getElementById('shop-voucher').value) || 0;

        const discountedAmount = (subtotal * (1 - (discountPerc / 100))) - voucher;
        const finalConverted = Math.max(0, discountedAmount * currentExchangeRate);

        document.getElementById('base-subtotal').textContent = `${baseCurr} ${subtotal.toFixed(2)}`;
        document.getElementById('shop-final').textContent = `${targetCurr} ${finalConverted.toLocaleString(undefined, {minimumFractionDigits: 2})}`;
    }

    // --- EVENT LISTENERS ---
    ['base-currency', 'target-currency', 'input-amount', 'shop-discount', 'shop-voucher'].forEach(id => {
        document.getElementById(id).addEventListener('input', () => {
            if (id.includes('currency')) {
                fetchRate();
                renderList(); // re-render to update currency labels
            } else {
                updateUI();
            }
        });
    });

    // Support "Enter" key for adding items
    document.getElementById('item-input').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') addItem();
    });

    fetchRate();
</script>

</body>
</html>
